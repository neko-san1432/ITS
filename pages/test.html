<html><head><base href="." />
<title>MineBuild: A Block Building Game</title>
<style>
    body { margin: 0; overflow: hidden; }
    #game-container {
        width: 100vw;
        height: 100vh;
        background: skyblue;
    }
    .controls {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,0,0,0.5);
        padding: 10px;
        border-radius: 5px;
        color: white;
    }
    #inventory {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(0,0,0,0.5);
        padding: 10px;
        border-radius: 5px;
        color: white;
    }
    .block-type {
        width: 30px;
        height: 30px;
        display: inline-block;
        margin: 0 5px;
        cursor: pointer;
        border: 2px solid transparent;
    }
    .block-type.selected {
        border-color: white;
    }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
</head>
<body>
<div id="game-container"></div>
<div class="controls">
    WASD to move | Click to place block | Right-click to remove block | Space to jump
</div>
<div id="inventory">
    <div class="block-type selected" style="background: #8B4513" data-type="dirt"></div>
    <div class="block-type" style="background: #808080" data-type="stone"></div>
    <div class="block-type" style="background: #228B22" data-type="grass"></div>
</div>

<script>
let scene, camera, renderer, blocks = [];
let selectedBlock = 'dirt';

function init() {
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.getElementById('game-container').appendChild(renderer.domElement);

    // Add lighting
    const light = new THREE.AmbientLight(0xffffff, 0.6);
    scene.add(light);
    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.6);
    directionalLight.position.set(10, 20, 0);
    scene.add(directionalLight);

    // Create ground
    generateTerrain();

    camera.position.set(5, 10, 15);
    camera.lookAt(0, 0, 0);

    // Handle block selection
    document.querySelectorAll('.block-type').forEach(block => {
        block.addEventListener('click', () => {
            document.querySelector('.selected').classList.remove('selected');
            block.classList.add('selected');
            selectedBlock = block.dataset.type;
        });
    });

    // Handle block placement
    renderer.domElement.addEventListener('click', placeBlock);
    renderer.domElement.addEventListener('contextmenu', removeBlock);

    animate();
}

function generateTerrain() {
    const size = 20;
    for(let x = -size/2; x < size/2; x++) {
        for(let z = -size/2; z < size/2; z++) {
            createBlock('grass', x, -1, z);
        }
    }
}

function createBlock(type, x, y, z) {
    const colors = {
        dirt: 0x8B4513,
        stone: 0x808080,
        grass: 0x228B22
    };
    
    const geometry = new THREE.BoxGeometry(1, 1, 1);
    const material = new THREE.MeshPhongMaterial({ color: colors[type] });
    const block = new THREE.Mesh(geometry, material);
    
    block.position.set(x, y, z);
    block.userData.type = type;
    scene.add(block);
    blocks.push(block);
    
    return block;
}

function placeBlock(event) {
    event.preventDefault();
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();
    
    mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
    mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
    
    raycaster.setFromCamera(mouse, camera);
    const intersects = raycaster.intersectObjects(blocks);
    
    if(intersects.length > 0) {
        const intersect = intersects[0];
        const position = intersect.point.add(intersect.face.normal);
        
        createBlock(selectedBlock, 
            Math.round(position.x), 
            Math.round(position.y), 
            Math.round(position.z));
    }
}

function removeBlock(event) {
    event.preventDefault();
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();
    
    mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
    mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
    
    raycaster.setFromCamera(mouse, camera);
    const intersects = raycaster.intersectObjects(blocks);
    
    if(intersects.length > 0) {
        const block = intersects[0].object;
        scene.remove(block);
        blocks = blocks.filter(b => b !== block);
    }
}

let moveForward = false;
let moveBackward = false;
let moveLeft = false;
let moveRight = false;

document.addEventListener('keydown', (event) => {
    switch(event.key.toLowerCase()) {
        case 'w': moveForward = true; break;
        case 's': moveBackward = true; break;
        case 'a': moveLeft = true; break;
        case 'd': moveRight = true; break;
    }
});

document.addEventListener('keyup', (event) => {
    switch(event.key.toLowerCase()) {
        case 'w': moveForward = false; break;
        case 's': moveBackward = false; break;
        case 'a': moveLeft = false; break;
        case 'd': moveRight = false; break;
    }
});

function updateCamera() {
    const speed = 0.1;
    if(moveForward) camera.position.z -= speed;
    if(moveBackward) camera.position.z += speed;
    if(moveLeft) camera.position.x -= speed;
    if(moveRight) camera.position.x += speed;
}

function animate() {
    requestAnimationFrame(animate);
    updateCamera();
    renderer.render(scene, camera);
}

window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});

init();
</script>
</body></html>